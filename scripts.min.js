document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("hero-canvas");e&&function(e){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches,o=window.matchMedia("(min-width: 768px)").matches,n=window.matchMedia("(hover: hover) and (pointer: fine)").matches;if(t||!o)return;const r=e.getContext("2d");if(!r)return;const a=window.matchMedia("(prefers-color-scheme: dark)").matches,c=[{r:255,g:182,b:193,a:.6},{r:173,g:216,b:230,a:.6},{r:221,g:160,b:221,a:.6},{r:255,g:239,b:213,a:.5}],s=[{r:99,g:102,b:241,a:.7},{r:139,g:92,b:246,a:.7},{r:34,g:211,b:238,a:.6},{r:236,g:72,b:153,a:.6}],i=a?s:c;function d(){const t=e.parentElement.getBoundingClientRect();e.width=t.width,e.height=t.height}let l;function u(){l&&cancelAnimationFrame(l),l=requestAnimationFrame(d)}d(),window.addEventListener("resize",u);const m=i.map((t,o)=>({x:Math.random()*e.width,y:Math.random()*e.height,vx:.3*(Math.random()-.5),vy:.3*(Math.random()-.5),radius:150+200*Math.random(),color:t,phase:Math.random()*Math.PI*2}));let h,g=e.width/2,y=e.height/2,p=g,f=y,v=!1;n&&(e.parentElement.addEventListener("mousemove",t=>{const o=e.getBoundingClientRect();p=t.clientX-o.left,f=t.clientY-o.top,v=!0}),e.parentElement.addEventListener("mouseleave",()=>{v=!1}));let b=0;function E(){if(b+=.005,r.clearRect(0,0,e.width,e.height),g+=.1*(p-g),y+=.1*(f-y),m.forEach(t=>{t.x+=t.vx+.5*Math.sin(b+t.phase),t.y+=t.vy+.5*Math.cos(b+.7*t.phase),(t.x<-t.radius||t.x>e.width+t.radius)&&(t.vx*=-1),(t.y<-t.radius||t.y>e.height+t.radius)&&(t.vy*=-1);const o=r.createRadialGradient(t.x,t.y,0,t.x,t.y,t.radius);o.addColorStop(0,`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, ${t.color.a})`),o.addColorStop(.5,`rgba(${t.color.r}, ${t.color.g}, ${t.color.b}, ${.5*t.color.a})`),o.addColorStop(1,"rgba(0, 0, 0, 0)"),r.fillStyle=o,r.beginPath(),r.arc(t.x,t.y,t.radius,0,2*Math.PI),r.fill()}),v&&n){const e=300,t=r.createRadialGradient(g,y,0,g,y,e),o=a?"rgba(255, 255, 255, 0.12)":"rgba(99, 102, 241, 0.15)";t.addColorStop(0,o),t.addColorStop(1,"rgba(0, 0, 0, 0)"),r.globalCompositeOperation="screen",r.fillStyle=t,r.beginPath(),r.arc(g,y,e,0,2*Math.PI),r.fill(),r.globalCompositeOperation="source-over"}h=requestAnimationFrame(E)}let w=!1;function L(){w||(w=!0,E())}function S(){h&&(cancelAnimationFrame(h),h=null),w=!1}function k(){S(),window.removeEventListener("resize",u)}L(),document.addEventListener("visibilitychange",()=>{document.hidden?S():L()}),window.addEventListener("beforeunload",k)}(e);const t=document.querySelector(".menu-toggle"),o=document.querySelector(".nav-menu");t&&t.addEventListener("click",function(){o.classList.toggle("active");const e="true"===t.getAttribute("aria-expanded");t.setAttribute("aria-expanded",!e)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const n=document.querySelector(this.getAttribute("href"));n&&(n.scrollIntoView({behavior:"smooth",block:"start"}),o&&o.classList.contains("active")&&(o.classList.remove("active"),t.setAttribute("aria-expanded","false")))})}),document.querySelectorAll("[data-package]").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=this.getAttribute("data-package"),o=document.querySelector(`input[name="package"][value="${t}"]`);o&&(o.checked=!0,c());const n=document.querySelector("#enquiry");n&&n.scrollIntoView({behavior:"smooth"})})});const n=document.getElementById("setup-cost"),r=document.getElementById("monthly-cost"),a=document.getElementById("first-year-cost");function c(){let e=0,t=0;const o=document.querySelector('input[name="package"]:checked');o&&(e+=parseInt(o.getAttribute("data-setup"))||0,t+=parseInt(o.getAttribute("data-monthly"))||0);document.querySelectorAll('input[type="checkbox"][name^="addon-"]:checked').forEach(o=>{e+=parseInt(o.getAttribute("data-setup"))||0,t+=parseInt(o.getAttribute("data-monthly"))||0});const c=e+12*t;n&&(n.textContent="$"+e.toLocaleString()),r&&(r.textContent="$"+t.toLocaleString()+"/mo"),a&&(a.textContent="$"+c.toLocaleString())}document.querySelectorAll('input[name="package"]').forEach(e=>{e.addEventListener("change",c)}),document.querySelectorAll('input[type="checkbox"][name^="addon-"]').forEach(e=>{e.addEventListener("change",c)});const s=document.getElementById("enquiry-form");s&&s.addEventListener("submit",async function(e){e.preventDefault();const t=document.getElementById("submit-btn"),o=document.getElementById("form-message"),i=t.querySelector(".btn-text"),d=t.querySelector(".btn-loader"),l=document.getElementById("privacy-agree"),u=document.getElementById("contract-agree");if(!l.checked||!u.checked)return void(o&&(o.textContent="Please accept both legal acknowledgements to proceed.",o.className="form-message error",o.style.display="block"));t.disabled=!0,i.style.display="none",d.style.display="inline";const m=new FormData(s),h=document.querySelector('input[name="package"]:checked');let g={};h&&(g={package_name:h.value,setup_cost:parseInt(h.getAttribute("data-setup"))||0,monthly_cost:parseInt(h.getAttribute("data-monthly"))||0});const y=[],p=[];document.querySelectorAll('input[type="checkbox"][name^="addon-"]:checked').forEach(e=>{y.push(e.value),p.push({name:e.value,setup:parseInt(e.getAttribute("data-setup"))||0,monthly:parseInt(e.getAttribute("data-monthly"))||0})});const f={name:m.get("name"),business:m.get("business"),email:m.get("email"),phone:m.get("phone"),business_type:m.get("business-type"),location:m.get("suburb"),package:g,addons:p,addons_list:y.join(", "),total_setup:n?n.textContent:"$0",total_monthly:r?r.textContent:"$0/mo",first_year_total:a?a.textContent:"$0",message:m.get("message"),privacy_agreed:l.checked,contract_agreed:u.checked,submitted_at:(new Date).toISOString(),user_agent:navigator.userAgent};try{!0===window.DEBUG&&console.log("Enquiry Data:",f),await new Promise(e=>setTimeout(e,1500)),o&&(o.textContent="Thank you! We've received your enquiry and will be in touch within 24 hours.",o.className="form-message success",o.style.display="block"),s.reset(),c(),o.scrollIntoView({behavior:"smooth",block:"nearest"})}catch(e){console.error("Form submission error:",e),o&&(o.textContent="Sorry, there was an error submitting your enquiry. Please email us directly at hello@hevin.design",o.className="form-message error",o.style.display="block")}finally{t.disabled=!1,i.style.display="inline",d.style.display="none"}}),c();const i=document.querySelector(".featured-carousel");if(i){let m,h,g=!1;i.addEventListener("mousedown",e=>{g=!0,i.style.cursor="grabbing",m=e.pageX-i.offsetLeft,h=i.scrollLeft}),i.addEventListener("mouseleave",()=>{g=!1,i.style.cursor="grab"}),i.addEventListener("mouseup",()=>{g=!1,i.style.cursor="grab"}),i.addEventListener("mousemove",e=>{if(!g)return;e.preventDefault();const t=2*(e.pageX-i.offsetLeft-m);i.scrollLeft=h-t}),window.matchMedia("(hover: hover) and (pointer: fine)").matches&&(i.style.cursor="grab");const y=document.querySelector(".featured-carousel-wrapper .carousel-nav-prev"),p=document.querySelector(".featured-carousel-wrapper .carousel-nav-next");if(y&&p){function d(){const e=i.scrollLeft,t=i.scrollWidth-i.clientWidth;y.disabled=e<=0,p.disabled=e>=t-1}y.addEventListener("click",()=>{const e=i.querySelector(".featured-card").offsetWidth,t=parseInt(getComputedStyle(i).gap);i.scrollBy({left:-(e+t),behavior:"smooth"})}),p.addEventListener("click",()=>{const e=i.querySelector(".featured-card").offsetWidth,t=parseInt(getComputedStyle(i).gap);i.scrollBy({left:e+t,behavior:"smooth"})}),i.addEventListener("scroll",d),window.addEventListener("resize",d),d()}}const l=document.querySelector(".secondary-carousel");if(l){let f,v,b=!1;l.addEventListener("mousedown",e=>{b=!0,l.style.cursor="grabbing",f=e.pageX-l.offsetLeft,v=l.scrollLeft}),l.addEventListener("mouseleave",()=>{b=!1,l.style.cursor="grab"}),l.addEventListener("mouseup",()=>{b=!1,l.style.cursor="grab"}),l.addEventListener("mousemove",e=>{if(!b)return;e.preventDefault();const t=2*(e.pageX-l.offsetLeft-f);l.scrollLeft=v-t}),window.matchMedia("(hover: hover) and (pointer: fine)").matches&&(l.style.cursor="grab");const E=document.querySelector(".secondary-carousel-wrapper .secondary-prev"),w=document.querySelector(".secondary-carousel-wrapper .secondary-next");if(E&&w){function u(){const e=l.scrollLeft,t=l.scrollWidth-l.clientWidth;E.disabled=e<=0,w.disabled=e>=t-1}E.addEventListener("click",()=>{const e=l.querySelector(".secondary-card").offsetWidth,t=parseInt(getComputedStyle(l).gap);l.scrollBy({left:-(e+t),behavior:"smooth"})}),w.addEventListener("click",()=>{const e=l.querySelector(".secondary-card").offsetWidth,t=parseInt(getComputedStyle(l).gap);l.scrollBy({left:e+t,behavior:"smooth"})}),l.addEventListener("scroll",u),window.addEventListener("resize",u),u()}}});